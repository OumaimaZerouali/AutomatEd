name: PR Approval Request Send To Telegram

on:
  pull_request:
    types:
      - opened

jobs:
  send-approval-request:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Check if review is required
        id: review_check
        run: |
          REVIEW_REQUIRED=$(echo "${{ github.event }}" | jq -r '.pull_request.maintainer_can_modify')
          echo "::set-output name=review_required::$REVIEW_REQUIRED"

      - name: Send approval request to Telegram
        if: steps.review_check.outputs.review_required == 'true'
        run: |
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d "text=ðŸš€ Pull Request opened! Please review and approve: ${{ github.event.pull_request.html_url }}" \
            -d "parse_mode=Markdown"
